# Предсказание температуры стали
Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали.

## Задача
Построить модель, которая предскажет температуру стали в ковше после десульфурации, легирования и дополнительного нагрева.

*План действий*:
1. Загрузим и опишем данные
2. Проанализируем и предобработаем данные
3. Создадим признаки для обучения
4. Обучим разыне модели и выберем лучшую
5. Напишем общий отчет по проделанной работе

## Методы и технологии
- Предобработка данных
  - Обработка пропусков
  - Обработка дубликатов
  - Выявление и обработка аномалий
  - Изменение типов данных
- Исследовательский анализ данных
  - Построение графиков
  - Рассчет матрицы корреляции признаков
- Объединение таблиц
- Создание новых признаков для обучения
- Построение ML-моделей
  - LinearRegression
  - Ridge
  - RandomForestRegressor
  - CatBoostRegressor
  - LGBMRegressor
  - Подбор лучших гиперпараметров на кросс-валидации
  - Вычисление времени обучения и предсказания
- Рассчет доверительного интервала для MAE
- Выявление наиболее значимых признаков для обученной модели

## Используемые библиотеки
*pandas, numpy, matplotlib, seaborn, sklearn, catboost, lightgbm, IPython*

## Описание данных
Данные состоят из файлов, полученных из разных источников:

- `data_arc.csv` — данные об электродах;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

### Описание производственного процесса
Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша.

Из сплава выводится сера (десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (англ. tribe, «масса»).

Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.

Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. slab, «плита»).

## Вывод
Лучшей по качеству оказалась модель *CatBoostRegressor с гиперпараметрами: loss_function='MAE', iterations=150, learning_rate=0.1, depth=5. Ее итоговый MAE на тестовой выборке = 5.096613.* Это означает, что модель в среднем ошибается на 5.2 градуса от истинного значения. *С 95% вероятностью истинное значение лежит в диапазоне +-15 градусов от предсказанного моделью.* Модель обучается дольше чем почти все остальные, однако время предсказания оказалось минимальным.

Остальные модели показали себя тоже хорошо. Предпоследней по качеству оказалсь модель *Ridge* с MAE = 5.532129 (остает от фаворита всего на 0.43), но зато она выигрывает у остальных по времени обучения и предсказания. Поэтому если для заказчика важна скорость обучения и предсказания и он готов принебречь 0.4 градусами температуры, то *Ridge* будет лучшим вариантом.
